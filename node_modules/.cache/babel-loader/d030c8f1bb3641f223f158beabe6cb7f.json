{"ast":null,"code":"import { GoogleSpreadsheet } from \"google-spreadsheet\";\n\nasync function getSheet(sheetID) {\n  const doc = new GoogleSpreadsheet(sheetID, pageID);\n  const client_email = process.env.REACT_APP_SHEETS_CLIENT_EMAIL;\n  const private_key = process.env.REACT_APP_SHEETS_PRIVATE_KEY;\n\n  try {\n    await doc.useServiceAccountAuth({\n      client_email: client_email,\n      private_key: private_key\n    });\n    await doc.loadInfo();\n    const sheet = doc.sheetsById[pageID];\n    return sheet;\n  } catch (e) {\n    console.error('Error: ', e);\n  }\n} // Fetch a Google Sheet\n\n\nexport function getResponses(sheetLink) {\n  const sheetID = sheetLink.slice(sheetLink.lastIndexOf(\"/d/\") + 3, sheetLink.lastIndexOf('/edit#'));\n  const pageID = sheetLink.slice(sheetLink.lastIndexOf(\"gid=\") + 4, sheetLink.length);\n\n  const sheet = async () => await getSheet(sheetID);\n\n  console.log(sheet);\n}","map":{"version":3,"sources":["/Users/rhendren/walleye_sms/src/util/sheets.js"],"names":["GoogleSpreadsheet","getSheet","sheetID","doc","pageID","client_email","process","env","REACT_APP_SHEETS_CLIENT_EMAIL","private_key","REACT_APP_SHEETS_PRIVATE_KEY","useServiceAccountAuth","loadInfo","sheet","sheetsById","e","console","error","getResponses","sheetLink","slice","lastIndexOf","length","log"],"mappings":"AAAA,SAASA,iBAAT,QAAkC,oBAAlC;;AAEA,eAAeC,QAAf,CAAwBC,OAAxB,EAAiC;AAC7B,QAAMC,GAAG,GAAG,IAAIH,iBAAJ,CAAsBE,OAAtB,EAA+BE,MAA/B,CAAZ;AAEA,QAAMC,YAAY,GAAGC,OAAO,CAACC,GAAR,CAAYC,6BAAjC;AACA,QAAMC,WAAW,GAAGH,OAAO,CAACC,GAAR,CAAYG,4BAAhC;;AAEA,MAAI;AACA,UAAMP,GAAG,CAACQ,qBAAJ,CAA0B;AAC5BN,MAAAA,YAAY,EAAEA,YADc;AAE5BI,MAAAA,WAAW,EAAEA;AAFe,KAA1B,CAAN;AAIA,UAAMN,GAAG,CAACS,QAAJ,EAAN;AACA,UAAMC,KAAK,GAAGV,GAAG,CAACW,UAAJ,CAAeV,MAAf,CAAd;AACA,WAAOS,KAAP;AACH,GARD,CAQE,OAAOE,CAAP,EAAU;AACRC,IAAAA,OAAO,CAACC,KAAR,CAAc,SAAd,EAAyBF,CAAzB;AACH;AACJ,C,CAED;;;AACA,OAAO,SAASG,YAAT,CAAsBC,SAAtB,EAAiC;AACpC,QAAMjB,OAAO,GAAGiB,SAAS,CAACC,KAAV,CAAgBD,SAAS,CAACE,WAAV,CAAsB,KAAtB,IAA+B,CAA/C,EAAkDF,SAAS,CAACE,WAAV,CAAsB,QAAtB,CAAlD,CAAhB;AACA,QAAMjB,MAAM,GAAGe,SAAS,CAACC,KAAV,CAAgBD,SAAS,CAACE,WAAV,CAAsB,MAAtB,IAAgC,CAAhD,EAAmDF,SAAS,CAACG,MAA7D,CAAf;;AAEA,QAAMT,KAAK,GAAG,YAAY,MAAMZ,QAAQ,CAACC,OAAD,CAAxC;;AAEAc,EAAAA,OAAO,CAACO,GAAR,CAAYV,KAAZ;AACD","sourcesContent":["import { GoogleSpreadsheet } from \"google-spreadsheet\";\n\nasync function getSheet(sheetID) {\n    const doc = new GoogleSpreadsheet(sheetID, pageID);\n\n    const client_email = process.env.REACT_APP_SHEETS_CLIENT_EMAIL;\n    const private_key = process.env.REACT_APP_SHEETS_PRIVATE_KEY;\n\n    try {\n        await doc.useServiceAccountAuth({\n            client_email: client_email,\n            private_key: private_key,\n        });\n        await doc.loadInfo();\n        const sheet = doc.sheetsById[pageID];\n        return sheet;\n    } catch (e) {\n        console.error('Error: ', e);\n    }\n}\n\n// Fetch a Google Sheet\nexport function getResponses(sheetLink) {\n    const sheetID = sheetLink.slice(sheetLink.lastIndexOf(\"/d/\") + 3, sheetLink.lastIndexOf('/edit#'));\n    const pageID = sheetLink.slice(sheetLink.lastIndexOf(\"gid=\") + 4, sheetLink.length);\n\n    const sheet = async () => await getSheet(sheetID);\n\n    console.log(sheet);\n  }"]},"metadata":{},"sourceType":"module"}