{"ast":null,"code":"import firebase from \"./firebase\";\nexport async function apiRequest(path, method = \"GET\", data) {\n  const accessToken = firebase.auth().currentUser ? await firebase.auth().currentUser.getIdToken() : undefined;\n  return fetch(`/api/${path}`, {\n    method: method,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${accessToken}`\n    },\n    body: data ? JSON.stringify(data) : undefined\n  }).then(response => response.json()).then(response => {\n    if (response.status === \"error\") {\n      // Automatically signout user if accessToken is no longer valid\n      if (response.code === \"auth/invalid-user-token\") {\n        firebase.auth().signOut();\n      }\n\n      throw new CustomError(response.code, response.message);\n    } else {\n      return response.data;\n    }\n  });\n} // Create an Error with custom message and code\n\nexport function CustomError(code, message) {\n  const error = new Error(message);\n  error.code = code;\n  return error;\n}","map":{"version":3,"sources":["/Users/rhendren/walleye_sms/src/util/util.js"],"names":["firebase","apiRequest","path","method","data","accessToken","auth","currentUser","getIdToken","undefined","fetch","headers","Authorization","body","JSON","stringify","then","response","json","status","code","signOut","CustomError","message","error","Error"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,YAArB;AAEA,OAAO,eAAeC,UAAf,CAA0BC,IAA1B,EAAgCC,MAAM,GAAG,KAAzC,EAAgDC,IAAhD,EAAsD;AAC3D,QAAMC,WAAW,GAAGL,QAAQ,CAACM,IAAT,GAAgBC,WAAhB,GAChB,MAAMP,QAAQ,CAACM,IAAT,GAAgBC,WAAhB,CAA4BC,UAA5B,EADU,GAEhBC,SAFJ;AAIA,SAAOC,KAAK,CAAE,QAAOR,IAAK,EAAd,EAAiB;AAC3BC,IAAAA,MAAM,EAAEA,MADmB;AAE3BQ,IAAAA,OAAO,EAAE;AACP,sBAAgB,kBADT;AAEPC,MAAAA,aAAa,EAAG,UAASP,WAAY;AAF9B,KAFkB;AAM3BQ,IAAAA,IAAI,EAAET,IAAI,GAAGU,IAAI,CAACC,SAAL,CAAeX,IAAf,CAAH,GAA0BK;AANT,GAAjB,CAAL,CAQJO,IARI,CAQEC,QAAD,IAAcA,QAAQ,CAACC,IAAT,EARf,EASJF,IATI,CASEC,QAAD,IAAc;AAClB,QAAIA,QAAQ,CAACE,MAAT,KAAoB,OAAxB,EAAiC;AAC/B;AACA,UAAIF,QAAQ,CAACG,IAAT,KAAkB,yBAAtB,EAAiD;AAC/CpB,QAAAA,QAAQ,CAACM,IAAT,GAAgBe,OAAhB;AACD;;AAED,YAAM,IAAIC,WAAJ,CAAgBL,QAAQ,CAACG,IAAzB,EAA+BH,QAAQ,CAACM,OAAxC,CAAN;AACD,KAPD,MAOO;AACL,aAAON,QAAQ,CAACb,IAAhB;AACD;AACF,GApBI,CAAP;AAqBD,C,CAED;;AACA,OAAO,SAASkB,WAAT,CAAqBF,IAArB,EAA2BG,OAA3B,EAAoC;AACzC,QAAMC,KAAK,GAAG,IAAIC,KAAJ,CAAUF,OAAV,CAAd;AACAC,EAAAA,KAAK,CAACJ,IAAN,GAAaA,IAAb;AACA,SAAOI,KAAP;AACD","sourcesContent":["import firebase from \"./firebase\";\n\nexport async function apiRequest(path, method = \"GET\", data) {\n  const accessToken = firebase.auth().currentUser\n    ? await firebase.auth().currentUser.getIdToken()\n    : undefined;\n\n  return fetch(`/api/${path}`, {\n    method: method,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${accessToken}`,\n    },\n    body: data ? JSON.stringify(data) : undefined,\n  })\n    .then((response) => response.json())\n    .then((response) => {\n      if (response.status === \"error\") {\n        // Automatically signout user if accessToken is no longer valid\n        if (response.code === \"auth/invalid-user-token\") {\n          firebase.auth().signOut();\n        }\n\n        throw new CustomError(response.code, response.message);\n      } else {\n        return response.data;\n      }\n    });\n}\n\n// Create an Error with custom message and code\nexport function CustomError(code, message) {\n  const error = new Error(message);\n  error.code = code;\n  return error;\n}\n"]},"metadata":{},"sourceType":"module"}